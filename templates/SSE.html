<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <title>APP</title>
  <script>
    function save_comment(){
      let te = $('#comment').val()
      let star = $('#star').val()

      $.ajax({
          type: 'POST',
          url: '/test',
          data: {'te_give': te, 'star_give': star},
          success: function (response) {
          }
      })
    }
  </script>
</head>
<body>
  <h1>APP</h1>
  <div id="update"></div>
  <div id="update1"></div>
  <script>
    var eventSource = new EventSource("/listen")

    eventSource.addEventListener("message", function(e) {
      console.log(e.data)
    }, false)

    eventSource.addEventListener("online", function(e) {
      data = JSON.parse(e.data)
      document.querySelector("#update").innerText = data.update
        document.querySelector("#update1").innerText= parseInt(data.star)
    }, true)
  </script>
  <textarea id="comment">
  </textarea>
  <select class="form-select" id="star">
      <option selected>-- 선택하기 --</option>
      <option value="1">⭐</option>
      <option value="2">⭐⭐</option>
      <option value="3">⭐⭐⭐</option>
      <option value="4">⭐⭐⭐⭐</option>
      <option value="5">⭐⭐⭐⭐⭐</option>
  </select>
  <button type="submit" onclick="save_comment()">저장</button>
</body>
</html>